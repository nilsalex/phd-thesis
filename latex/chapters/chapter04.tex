\chapter{Perturbative construction of gravitational theories}
\label{chapter_perturbation}

\textit{Following the presentation of the axioms of covariant constructive gravity and the construction algorithm, we now develop a perturbative approach for the implementation of both axioms. The equivariance equations turn out to lend themselves to an iterative solution strategy where the expansion coefficients of a power series ansatz are determined iteratively, power by power. A first approximation of the gravitational theory valid for weak fields is obtained already after the second iteration, which yields a quadratic Lagrangian with linear field equations. In a sense, this is the free theory without self-coupling. In order to investigate the lowest-order effects of gravitational self-coupling, which we will dare in the subsequent chapter, the next order is indispensable. Therefore, after establishing the general principle, we focus on the perturbation theory up to third order in the Lagrangian.}

\textit{The development in this chapter follows closely the presentation in Ref.\ \cite{Alex_2020}, but is at times more detailed.}

\section{Perturbative implementation of axiom 1}

Let us state again, for reference, the equivariance equations \eqref{equivariance_eqn_2}--\eqref{equivariance_eqn_4} we are going to solve perturbatively:
\begin{equation*}
    \begin{aligned}
      0 = {} & L_{:A} \gmc{A}{B}{n}{m}u^B + L_{:A}^{\hphantom{:A}p}\left\lbrack\gmc{A}{B}{n}{m} \delta^q_p - \delta^A_B\delta^q_m\delta^n_p\right\rbrack u^{B}_{\hphantom Bq} \nonumber \\
      {} & + L_{:A}^{\hphantom{:A}I} \left\lbrack\gmc{A}{B}{n}{m} \delta^J_I - 2 \delta^A_B J^{pn}_{I} I^J_{pm}\right\rbrack u^B_{\hphantom BJ} + L\delta^n_m, \\
      0 = {} & L_{:A}^{\hphantom{:A}(p\mid} \gmc{A}{B}{\mid n)}{m} u^B + L_{:A}^{\hphantom{:A}I}\left\lbrack\gmc{A}{B}{(n}{m} 2J^{p)q}_I - \delta^A_B J^{pn}_I \delta^q_m\right\rbrack u^B_{\hphantom Bq}, \\
      0 = {} & L_{:A}^{\hphantom{:A}I} \gmc{A}{B}{(n}{m} J^{pq)}_I u^B.
    \end{aligned}
\end{equation*}
The first equivariance equation $0 = L_{,m}$ has been omitted, because from now on we will consider it solved by restricting the problem to Lagrangian densities $L$ that depend only on the fibre coordinates.

Perturbation theory starts with choosing an expansion point $p\in J^2E$. Let $p$ have fibre coordinates $(N^A,N^A_{\hphantom Ap},N^A_{\hphantom AI})$. The deviation of any point $q\in J^2E$ with fibre coordinates $(G^A,G^A_{\hphantom Ap},G^A_{\hphantom AI})$ is then defined as the difference
\begin{equation}
  (H^A, H^A_{\hphantom Ap}, H^A_{\hphantom AI}) \vcentcolon= (G^A - N^A, G^A_{\hphantom Ap} - N^A_{\hphantom Ap}, G^A_{\hphantom AI} - H^A_{\hphantom AI}).
\end{equation}
Around $p$, this results in the formal power series ansatz
\begin{equation}\label{power_series_ansatz}
  \begin{aligned}
    L &{} = a + a_A H^A + a_A^{\hphantom Ap} H^A_{\hphantom Ap} + a_A^{\hphantom AI} H^A_{\hphantom AI} \\
      &{} \hphantom{=} + a_{AB} H^A H^B + a_{AB}^{\hphantom{AB}p} H^A H^B_{\hphantom Bp} + a_{AB}^{\hphantom{AB}I} H^A H^B_{\hphantom BI} \\
      &{} \hphantom{=} + a_{A\hphantom{p}B}^{\hphantom Ap\hphantom{B}q} H^A_{\hphantom Ap} H^B_{\hphantom Bq} + a_{A\hphantom{p}B}^{\hphantom Ap\hphantom{B}I} H^A_{\hphantom Ap} H^B_{\hphantom BI} + a_{A\hphantom{I}B}^{\hphantom AI\hphantom{B}J} H^A_{\hphantom AI} H^B_{\hphantom BJ} \\
      &{} \hphantom{=} + a_{ABC} H^A H^B H^C + \dots,
  \end{aligned}
\end{equation}
which is called \emph{formal} because at this point there is no assumption about the convergence of the power series. We do, however, make two assumptions about admissible expansion points, in order to justify the interpretation of perturbatively constructed theories as valid theories for \emph{weak} gravitational fields.
\begin{enumerate}
  \item{The expansion point represents a \emph{flat} instance of the gravitational field, i.e.\ both $N^A_{\hphantom Ap}$ and $N^A_{\hphantom AI}$ vanish.}
  \item{At the expansion point, the matter theory that is used to bootstrap the construction procedure reduces to a theory that is equivalent to a matter theory on Minkowski spacetime.}
\end{enumerate}
Both restrictions for $p$ ensure that the limit of weak gravitational fields can match our observations for situations with weak gravity: Matter fields couple to flat geometry in the sense that there are coordinate charts where the geometric coefficients are constant and this geometry is determined by the Minkowski metric. Curvature effects and effects from non-Lorentzian geometry are expected to arise as \emph{deviations} from this ground state. After all, this is just another incarnation of the correspondence principle for modified gravity.

The first assumption is easily implemented: In the chosen coordinate chart, $p$ takes the form $(N^A,0,0)$. The best way to make sense of the second assumption is by considering a few examples:
\begin{example}[flat Lorentzian expansion points]\label{example_expansion_points}
  Let us choose appropriate expansion points $(N^A,0,0)$ for GLED and bimetric theories introduced in Sections~\ref{section_gled} and~\ref{section_bimetric}, respectively. In order to satisfy the second assumption made for expansion points, we construct $N^A$ from the Minkowski metric $\eta^{ab} = \operatorname{diag}(1,-1,-1,-1)^{ab}$ in the following ways.
  \begin{enumerate}
    \item{For bimetric theories, a suitable expansion point is given by $N^{\bar A} = J_{ab}^{\bar A} \eta^{ab}$ and $N^{\bar{\bar A}} = J_{ab}^{\bar{\bar A}} \eta^{ab}$, i.e.\ setting both metrics $g$ and $h$ equal to $\eta$. Where a scalar density is needed, we choose $\omega = \sqrt{-\operatorname{det}\eta} = 1$. This choice reduces the bimetric Klein-Gordon theory to the standard Klein-Gordon theory for two scalar fields on Minkowski spacetime
      \begin{equation}
        L_\text{2KG}\big\rvert_N = \eta^{ab} \phi_{,a} \phi_{,b} - m_\phi^2\phi^2 + \eta^{ab} \psi_{,a} \psi_{,b} - m_\psi^2\psi^2.
      \end{equation}
    Similarly, the refined Proca theory reduces to the standard Proca theory
      \begin{equation}
        L_\text{bi-Proca}\big\rvert_N = -\eta^{ac}\eta^{bd}F_{ab}F_{cd} + m^2\eta^{ab}A_aA_b.
      \end{equation}}
    \item{For GLED, we choose the expansion point $N^A = J_{abcd}^A (\eta^{ac} \eta^{bd} - \eta^{ad} \eta^{bc} + \epsilon^{abcd})$. Using the density $\omega_G = (\frac{1}{24}\epsilon_{abcd}G^{abcd})^{-1}$, which at $G^A=N^A$ results in $\omega_N = 1$, the Lagrangian density for GLED reduces to
        \begin{equation}\label{GLED_reduction}
        L_\text{GLED} = 2 \eta^{ac}\eta^{bd} F_{ab}F_{cd},
      \end{equation}
    i.e.\ Maxwell electrodynamics on Minkowski spacetime.\footnote{The term $\epsilon^{abcd}F_{ab}F_{cd}$ is a surface term and thus does not contribute to the field equations. As such, it has been omitted in Eq.~\ref{GLED_reduction}.}}
  \end{enumerate}
\end{example}
Both choices of expansion points ensure that the perturbatively constructed gravitational theories provide to zeroth order in the deviation a background on which known physics is reproduced. Novel physics---the coupling of matter fields to non-metric geometries and the self-coupling of such geometries---should emerge as effect of first and higher orders in the deviation from the Minkowski background.

Having defined an expansion point, the equivariance equations can---in principle---be solved perturbatively by repeating the following process: All equations in the system contain derivatives of first order, so the expansion coefficient $a$ of zeroth order remain undetermined. In order to determine the expansion coefficients $a_A$, $a_A^{\hphantom Ap}$, and $a_A^{\hphantom aI}$, substitute the formal power series ansatz \eqref{power_series_ansatz} for the Lagrangian density $L$ in the equivariance equations, evaluate the result at $N$ (i.e.\ set the deviation $H$ to zero) and solve the resulting linear equations for the first-order coefficients. Next, differentiate each PDE once with respect to every independent variable, substitute again the power series ansatz, evaluate at $N$ and solve the linear system for the expansion coefficients of second order. Now repeat this process of differentiation, substitution, evaluation, and solving of linear equations \emph{ad infinitum}---or up to the desired perturbation order.

\section{Involution analysis}
For the previously described perturbative solution process to play out as desired, the PDE system must observe an important property: we need to be sure that each step really determines all expansion coefficients for the corresponding order to the extent that this is possible\footnote{Of course, the equivariance equations, in general, will not determine \emph{all} expansion coefficients. Rather, the solutions will be parameterized exactly by the coefficients that cannot be determined.}. This is not always guaranteed, as a simple example demonstrates.
\begin{example}[integrability conditions \cite{Seiler_2002}]\label{example_involution_1}
  Consider the linear, first-order PDE system
  \begin{equation}\label{example_integrability_condition}
    \begin{aligned}
      u_{,z} + y u_{,x} &{} = 0, \\
      u_{,y} &{} = 0
    \end{aligned}
  \end{equation}
  for one function $u$ which depends on three independent variables $x,y,z$. Making a formal power series ansatz, inserting this ansatz into the system \eqref{example_integrability_condition}, and evaluating at the expansion point yields a linear system of rank two for the three expansion coefficients of first order.

  There are, however, hidden equations governing the first order, which emerge after differentiating the first equation with respect to $y$ and the second equation with respect to $z$ and $x$. This gives new PDEs
  \begin{equation}
    \begin{aligned}
      u_{,yz} + y u_{,xy} + u_{,x} &{} = 0, \\
      u_{,xy} &{} = 0, \\
      u_{,yz} &{} = 0.
    \end{aligned}
  \end{equation}
  The second derivatives in the first equation can be cancelled using the second and third equation, yielding the first-order PDE $u_{,x} = 0$. Such a new equation that is algebraically independent of the original PDEs \eqref{example_integrability_condition} is called an \textbf{integrability condition}. Including it in the first-order system and simplifying a bit, we get
  \begin{equation}
    \begin{aligned}
      u_{,x} &{} = 0, \\
      u_{,y} &{} = 0, \\
      u_{,z} &{} = 0.
    \end{aligned}
  \end{equation}
  Only after performing this procedure of making explicit the hidden first-order PDEs, we know for sure that the expansion coefficients of first order are determined already after the first iteration. In this case, the resulting linear system has full rank, leaving no coefficient undetermined.
\end{example}
Luckily, the system of equivariance equations suffers none of these maladies, as we will prove in the following. The mathematical framework that allows to make such a statement is \emph{involution theory} \cite{Seiler_2010}. Within this framework, a PDE of order $q$ is defined geometrically as fibred submanifold $R_q\subseteq J^qE$ of some jet bundle manifold $J^qE$.\footnote{Note that this jet bundle is \emph{not} the jet bundle on which the Lagrangian density is defined. For the equivariance equations, the order $q$ is 1 and the underlying bundle $E$ is $J^2E_\text{geometry}$.} A local coordinate representation of $R_q$ yields a system of equations, more closely resembling what a PDE looks like in the non-geometric picture. Note that we deliberately call $R_q$ a partial differential \emph{equation}, rather than using the plural, as this approach makes no difference between systems or scalar equations. A solution to a PDE is just a local section $\sigma$ of $E$ such that the image of $j^q\sigma$ is contained within $R_q$.

Two geometric operations will be performed repeatedly on PDEs for their involution analysis: \emph{prolongation} and \emph{projection}. The former maps a PDE $R_q$ to some PDE $R_{q+r}$ by, in local coordinates, adding to $R_q$ all possible derivatives of order $r$ of the individual equations---the geometric construction is a bit more involved. On the contrary, it is simpler to define projections geometrically, which is as bundle projections $R^{(r)}_{q-r} = \pi_{q,q-r}(R_q)$. Using a local representation of $R_q$, the projection is performed by eliminating derivatives of higher orders using only algebraic manipulations such that equations of order $q-r$ remain. The maximal set of such equations is a representation of $R_{q-r}$. For linear systems, the task of projecting a PDE to lower order is solved by linear algebra with tools like Gaussian elimination and has already been demonstrated earlier in Example~\ref{example_involution_1}.

With this, the main result can be established.

\begin{theorem}[formal integrability of equivariance equations]\label{thm_formal_integrability}
  The equivariance equations are a formally integrable partial differential equation $R_q$ with $q=1$, i.e.\ it holds for all $r>0$ that $R^{(1)}_{q+r} = R_{q+r}$.
\end{theorem}

Formal integrability as defined in Thm.~\ref{thm_formal_integrability} captures in geometric terms the requirement a PDE must satisfy in order for the iterative solution strategy to succeed. Otherwise, a truncated power series solution---which will later serve as approximate solution for weak gravitational fields---could never be trusted, as prolongations of the PDE to higher orders could always yield additional constraints on the coefficients of the truncated series.

The equivariance equations fall into such a simple category that their formal integrability can be proven in a very straightforward way. According to Example 2.3.12 of Ref.\ \cite{Seiler_2010}, the possible integrability conditions for a PDE of order $q=1$ for a single dependent variable are given by a certain commutator of the local PDE representatives. See \cite{Seiler_2010} for the details. Adapting this technique to the system of equivariance equations, we can prove that the integrability conditions are already contained in the system to begin with.

\begin{proof}[Proof of Thm.~\ref{thm_formal_integrability}]
  The system \eqref{equivariance_eqn_1}--\eqref{equivariance_eqn_4} of equivariance equations is equivalent (by its derivation) to the equation
  \begin{equation}\label{equivariance_eqn_vector}
    0 = \xi_{J^2E}L + L \cdot \xi^m_{,m}
  \end{equation}
  for all vector fields $\xi$ over $M$. With $\xi_{J^2E}$ we denoted the lift to the second jet bundle over the field bundle. Applying the same technique as in Example 2.3.12 of Ref.\ \cite{Seiler_2010}, we generate all possible integrability conditions by acting with a second vector field $\psi_{J^2E}$ on Eq.\ \eqref{equivariance_eqn_vector} and subtracting the same equation with the roles of $\xi$ and $\psi$ switched. These conditions turn out to be
  \begin{equation}
    \begin{aligned}
      0 = {} & \lbrack \xi_{J^2E}, \psi_{J^2E}\rbrack L + L\cdot \lbrack\xi,\psi\rbrack^m_{,m} \\
          {} & - \left( \psi_{J^2E}L + L \cdot \psi^m_{,m}\right) \xi^n_{,n} \\
          {} & + \left( \xi_{J^2E}L + L \cdot \xi^m_{,m}\right) \psi^n_{,n} \\
          = {} & \lbrack\xi,\psi\rbrack_{J^2E}L + L \cdot \lbrack\xi,\psi\rbrack^m_{,m} \\
          {} & - \left( \psi_{J^2E}L + L \cdot \psi^m_{,m}\right) \xi^n_{,n} \\
          {} & + \left( \xi_{J^2E}L + L \cdot \xi^m_{,m}\right) \psi^n_{,n},
    \end{aligned}
  \end{equation}
  which is a linear combination of equations that are already contained in the system. Note how the Lie algebra homomorphism property of the vector field lift is crucial for this result.

  Since it is impossible to generate integrability conditions that are not already present in the system, the equivariance equations are formally integrable.
\end{proof}

For more involved PDEs, formal integrability is in practice proven by showing that the system is \emph{involutive}, from which formal integrability follows. This comes with an algebraic condition on the PDE, which boils down to calculating a matrix rank for our particular PDE\@. However, it has still to be checked that a single prolongation does not generate new integrability condition---which amounts to the calculation above. So in this case, nothing would be gained by pursuing this approach. See \cite{Seiler_2010,Reinhart_2019} for a proof of involutivity.

\section{Lorentz invariant ansätze}

In order to implement the second assumption for suitable expansion points in the power series ansatz, we choose coordinate representations where the flat geometry is Lorentz invariant, i.e.\ satisfies the Lorentz invariance conditions
\begin{equation}\label{lorentz_invariance_N}
  0 = N^A \gmc{B}{A}{n}{m} (K_{(i)})^m_n,
\end{equation}
where $K_{(i)}$ are the 6 generators $\{ \eta^{m\lbrack r}\delta^{s\rbrack}_n \mid r < s \}$ of the Lorentz group. This special symmetry of the expansion point carries over to the equivariance equations and causes rank defects, for example in the second equivariance equation \eqref{equivariance_eqn_2}. At a generic (non-Lorentz invariant) point $p=(x^i,M^A,0,0)$, it reads
\begin{equation}
  0 = L_{:A}\rvert_p \gmc{A}{B}{n}{m} M^B + L\rvert_p \delta^n_m
\end{equation}
and is, in general, of rank 16. Evaluating the same equation at $p_0 = (x^i,N^A,0,0)$ and contracting with Lorentz generators $K_{(i)}$, we obtain the 6 vanishing linear combinations
\begin{equation}
  \begin{aligned}
    0 &{} = L_{:A}\rvert_{p_0} \gmc{A}{B}{n}{m} N^B (K_{(i)})^m_n + L\rvert_{p_0} \delta^n_m (K_{(i)})^m_n \\
      &{} = 0.
  \end{aligned}
\end{equation}
In the end, only 10 equations remain linearly independent. While at the first glance this seems to reduce the number of determinable expansion coefficients, the inverse is actually true: Consider again the second equivariance equation and calculate the prolongation with respect to the variables $u^A$. Evaluated at $p_0$, this gives
\begin{equation}
  0 = L_{:A:B}\rvert_{p_0} \gmc{B}{C}{n}{m} N^C + L_{:B}\rvert_{p_0} \gmc{B}{A}{n}{m} + L_{:A}\rvert_{p_0} \delta^n_m,
\end{equation}
which contracted with the Lorentz generators reduces again to first-order equations
\begin{equation}\label{ansatz_equation}
  0 = L_{:B}\rvert_{p_0}\gmc{B}{A}{n}{m}(K_{(i)})^m_n.
\end{equation}
Comparing this equation with Eq.~\ref{lorentz_invariance_N} emphasizes its significance: It mandates Lorentz invariance of the expansion coefficients $L_{:B}\rvert_{p_0} = a_B$.

Similar results hold for all other expansion coefficients and are obtained exactly the same way: Calculate prolongations of the second equivariance equation, evaluate at the Lorentz invariant expansion point, and contract with the Lorentz generators. While this yields new independent equations of order $q$ by prolongation to order $q+1$ and subsequent projection, it is important not to conflate the Lorentz invariance conditions on expansion coefficients with integrability conditions from involution theory. The former are an artefact of the expansion point with additional symmetries and are as such only valid exactly there, while an integrability condition would not be restricted to singular points.

When solving the equivariance equations iteratively, we could just include the Lorentz invariance conditions and solve them together with the original equations. A better way is to exploit the nature of the additional conditions and implement Lorentz invariance of the expansion coefficients \emph{before} substituting the ansatz in the equivariance equations. For example, working on the metric bundle, rather than including the 60 equations
\begin{equation}
  a_B \gmc{B}{A}{n}{m}(K_{(i)})^m_n
\end{equation}
for the 10-dimensional ansatz $a_B$, we implement Lorentz invariance by reducing $a_B$ to the ansatz
\begin{equation}
  a_B = c\cdot J_B^{ab} \eta_{ab}
\end{equation}
with just one undetermined coefficient. Not only did we get by without adding equations to the system, but we reduced the number of unknowns significantly.

A particular reduction we can perform right now is to set expansion coefficients with an \emph{odd} number of indices to zero.\footnote{For field bundles that are defined as proper subbundle of some ``unrestricted'' tensor bundle, the number of indices refers to the rank of the latter.} Assuming that the number of indices on the geometry is even\footnote{Otherwise, we would not be able to define a Lorentz invariant expansion point to begin with.}, this removes all coefficients with odd total number of derivatives from the ansatz, e.g.\ $a_{A\hphantom pB}^{\hphantom Ap\hphantom BI}=0$.

\section{Perturbative implementation of axiom 2}\label{section_axiom2_perturb}

Before deriving consequences from the second axiom for the perturbatively constructed solutions, we can already infer restrictions on the perturbation ansatz. As the matter Lagrangians considered here depend on the geometry only locally, and so do the corresponding principal polynomials, a matching gravitational polynomial must also depend on the geometry locally, i.e.\ not via derivatives. In order to enforce this, we remove ansätze with a total number of derivatives greater than two and obtain the general ansatz
\begin{equation}\label{ansatz_reduced}
  \begin{aligned}
    L &{} = a + a_A H^A + a_A^{\hphantom AI} H^A_{\hphantom AI} + a_{AB} H^A H^B + a_{AB}^{\hphantom{AB}I} H^A H^B_{\hphantom BI} + a_{A\hphantom pB}^{\hphantom Ap\hphantom Bq} H^A_{\hphantom Ap} H^B_{\hphantom Bq} \\
      &{} \hphantom{=} + a_{ABC} H^A H^B H^C + a_{ABC}^{\hphantom{ABC}I} H^A H^B H^C_{\hphantom CI} + a_{AB\hphantom pC}^{\hphantom{AB}p\hphantom Cq} H^A H^B_{\hphantom Bp} H^C_{\hphantom Cq} + \dots \hspace{2pt}.
  \end{aligned}
\end{equation}
As discussed before, all expansion coefficients are Lorentz invariant.

Now, consider a solution of the equivariance equations for the ansatz \eqref{ansatz_reduced}, truncated at order $q$. The corresponding field equations will be of order $q-1$ and the principal symbol, consequently, of order $q-2$. The second axiom of covariant constructive gravity is implemented perturbatively by matching the expansion
\begin{equation}\label{expansion_matter_poly}
  \mathcal P_\text{mat} = (P^{(0)}_\text{mat}) + (P^{(1)}_\text{mat})_A H^A + \dots + (P^{(q-2)}_\text{mat})_{A_1\dots A_{q-2}} H^{A_1} \dots H^{A_{q-2}} + \mathcal O(q-1)
\end{equation}
of the matter polynomial with the expansion
\begin{equation}\label{expansion_grav_poly}
  \mathcal P_\text{grav} = (P^{(0)}_\text{grav}) + (P^{(1)}_\text{grav})_A H^A + \dots + (P^{(q-2)}_\text{grav})_{A_1\dots A_{q-2}} H^{A_1} \dots H^{A_{q-2}} + \mathcal O(q-1)
\end{equation}
of the gravitational polynomial. Note that a ``match'' does not necessarily mean that both polynomials coincide, but rather that the causalities are compatible in the sense of Def.~\ref{causal_compatibility_def}.

While the expansion \eqref{expansion_matter_poly} generally follows from a closed form for the matter principal polynomial, we only have the currently constructed orders of the gravitational Lagrangian at our disposal when calculating terms from Eq.~\ref{expansion_grav_poly}. The process to arrive at the gravitational polynomial from there by expanding the definition \eqref{principal_polynomial}, however, is straightforward. We restrict our attention to the order $q-1=2$ in the field equations, which is the maximum order we will consider for a concrete example later, but the calculations can be generalized to higher orders if necessary.

The principal polynomial was defined in Def.~\ref{def_principal_polynomial} as the quotient of a non-vanishing entry from the order-$s$ adjugate $Q(k)$ corresponding to the symbol $T(k)$ and an expression built from the generators $\chi_{(i)}(k)$ of the gauge symmetry,
\begin{equation}\label{principal_polynomial_repeat}
    \mathcal P(k) = \frac{Q^{A_1\dots A_sB_1\dots B_s}}{\epsilon^{\mu_1\dots\mu_s}\epsilon^{\nu_1\dots\nu_s}\left\lbrack\prod_{i=1}^s\chi_{(\mu_i)}^{A_i}\right\rbrack\left\lbrack\prod_{j=1}^s\chi_{(\nu_j)}^{B_j}\right\rbrack}.
\end{equation}
We start the expansion of Eq.~\ref{principal_polynomial_repeat} with separating the perturbation orders in the vectors $\chi_{(n)}(k)$ as 
\begin{equation}
  \chi_{(n)}^A(k) = \gmc{A}{B}{m}{n}N^Bk_m + \gmc{A}{B}{m}{n}H^Bk_m =\vcentcolon (\chi^{(0)})^A_n(k) + (\chi^{(1)})^A_{Bn}(k)H^B.
\end{equation}
From there, the denominator in Eq.~\ref{principal_polynomial_repeat}, which will be abbreviated as $f^{A_1\dots A_sB_1\dots B_s}(k)$ in the following, can be expanded into
\begin{equation}\label{expansion_f}
  f^{A_1\dots A_sB_1\dots B_s}(k) = (f_{(0)})^{A_1\dots A_sB_1\dots B_s}(k) + (f_{(1)})^{A_1\dots A_sB_1\dots B_s}_C(k)H^C + \mathcal O(2).
\end{equation}
For the numerator, we choose a submatrix $T^{A_1\dots A_sB_1\dots B_s}(k)$ of the principal symbol $T(k)$ which is of full rank, i.e.\ has a non-vanishing determinant.\footnote{This sounds like a hard problem in practice, but turns out to be quite feasible. While the matrices contain symbolic entries given by undetermined expansion coefficients of the Lagrangian density and covector components $k_a$, ranks can actually be calculated using randomly drawn numeric values for the symbolic entries. In the worst case, we introduce additional linear dependencies and obtain a lower rank. If the rank obtained by such a calculation is maximal, on the other hand, we have nothing to worry about and can trust the result. For the examples encountered later on, it is possible to perform all calculations with arbitrary precision arithmetic on integers and use fraction-free Gaussian elimination, yielding results without any numerical instabilities.}
The determinant of this submatrix will be (up to, possibly, an irrelevant sign) the entry of the adjugate matrix entering the principal polynomial definition \eqref{principal_polynomial_repeat}. Recalling the expansion of the matrix determinant
\begin{equation}
  \operatorname{det}(A + \epsilon B) = \operatorname{det}(A) \operatorname{det}(I + \epsilon A^{-1} B) = \operatorname{det}(A) (1 + \epsilon \operatorname{Tr}(A^{-1} B)) + \mathcal O(\epsilon^2),
\end{equation}
and expanding the submatrix of the principal symbol as
\begin{equation}
  T^{A_1\dots A_sB_1\dots B_s}(k) = (T_{(0)})^{A_1\dots A_sB_1\dots B_s}(k) + (T_{(1)})^{A_1\dots A_sB_1\dots B_s}_C(k)H^C + \mathcal O(2),
\end{equation}
we arrive at the expansion of $Q^{A_1\dots A_sB_1\dots B_s}(k)$,
\begin{equation}\label{expansion_minor}
  \begin{aligned}
    \pm Q^{A_1\dots A_sB_1\dots B_s}(k)     = &{} \operatorname{det}(T^{A_1\dots A_sB_1\dots B_s}(k)) \\
                                            = &{} \operatorname{det}((T_{(0)})^{A_1\dots A_sB_1\dots B_s}(k)) \\
                                            &{} \times \lbrack 1 + (T_{(0)})^{A_1\dots A_sB_1\dots B_s}(k)^{-1}(T_{(1)})^{A_1\dots A_sB_1\dots B_s}_C(k)H^C\rbrack \\
                                            &{} + \mathcal O(2) \\
                                            = &{} (D_{(0)})^{A_1\dots A_sB_1\dots B_s}(k) + (D_{(1)})^{A_1\dots A_sB_1\dots B_s}_C(k) H^C.
    \end{aligned}
\end{equation}
The last equality introduces abbrevations $D_{(0)}$ and $D_{(1)}$ for the expansion coefficients of $Q$. In order to take the quotient of $Q$ and $f$, it remains to calculate the multiplicative inverse 
\begin{equation}
  \begin{aligned}
    f^{A_1\dots A_sB_1\dots B_s}(k)^{-1} = &{} (f_{(0)})^{A_1\dots A_sB_1\dots B_s}(k)^{-1} \\
                                               &{} \times \lbrack 1 - (f_{(0)})^{A_1\dots A_sB_1\dots B_s}(k)^{-1}(f_{(1)})^{A_1\dots A_sB_1\dots B_s}_C(k)H^C \rbrack \\
                                               &{} + \mathcal O(2).
  \end{aligned}
\end{equation}
Finally, the product of $Q$ and $f^{-1}$ yields the expansion
\begin{equation}
  \pm \mathcal P(k) = P^{(0)}(k) + (P^{(1)})_C(k) H^C + \mathcal O(2),
\end{equation}
of the principal polynomial with coefficients
\begin{equation}\label{expansion_coefficients_poly}
  \begin{aligned}
    P^{(0)}(k) &{} = \frac{(D_{(0)})^{A_1\dots A_sB_1\dots B_s}(k)}{(f_{(0)})^{A_1\dots A_sB_1\dots B_s}(k)}, \\
    P^{(1)}_C(k) &{} = \frac{(D_{(1)})^{A_1\dots A_sB_1\dots B_s}_C(k) - (f_{(1)})^{A_1\dots A_sB_1\dots B_s}_C(k) \cdot P^{(0)}(k)}{(f_{(0)})^{A_1\dots A_sB_1\dots B_s}(k)}.
  \end{aligned}
\end{equation}

The thus obtained relevant order of the gravitational principal polynomial may be compared with an expansion of the principal polynomial originating from the matter theory. Focusing not on an exact correspondence, but rather on the perturbative version of axiom 2 to second order,
\begin{equation}
  C_\text{mat} = C_\text{grav} + \mathcal O(2) \quad\text{and}\quad V_\text{mat} \subseteq V_\text{grav} + \mathcal O(2),
\end{equation}
restricts the perturbative solution of the equivariance equations to the causally compatible sector.

\section{The perturbative construction algorithm}

Having elaborated in detail all the steps necessary in order to construct approximate solutions to the equivariance equations and causal compatibility conditions, it is worthwile to take a step back and collect the results in the form of a concise algorithm.

\begin{algorithm}[H]\label{perturbative_algorithm}
  \DontPrintSemicolon
  \KwData{Geometry bundle $E_\text{grav}\overset{\pi_\text{grav}}{\longrightarrow}M$, matter bundle $E_\text{mat}\overset{\pi_\text{mat}}{\longrightarrow}M$,
  Lagrangian matter field theory on $E_\text{grav} \oplus_M J^1E_\text{mat}$ with linear field equations, expansion order $q\geq 2$, Lorentz invariant expansion point $(N^A,0,0)$}
  \KwResult{Truncated power series of the most general diffeomorphism invariant and causally compatible gravitational Lagrangian field theory on $J^2E_\text{grav}$}
  compute the Gotay-Marsden coefficients \eqref{gmc_contra} for $E_\text{grav}$ \;
  construct a basis for the Lorentz invariant expansion coefficients in the ansatz \eqref{ansatz_reduced}\;
  calculate prolongations up to order $q$ of the equivariance equations \eqref{equivariance_eqn_2}--\eqref{equivariance_eqn_4} \;
  evaluate the prolongations at the expansion point $N$ \;
  solve the resulting linear system for the expansion coefficients \;
  compute the expansion of the gravitational principal symbol $T_\text{grav}(k)$ \;
  choose a submatrix $T^{A_1\dots A_4B_1\dots B_4}(k)$ of $T_\text{grav}(k)$ which is of full rank \;
  compute the expansion \eqref{expansion_minor} of the submatrix determinant (the \emph{numerator}) \;
  compute the expansion \eqref{expansion_f} of $f^{A_1\dots A_4B_1\dots B_4}(k)$ (the \emph{denominator}) \;
  from the numerator and denominator, compute the expansion \eqref{expansion_coefficients_poly} of $\mathcal P_\text{grav}(k)$ \;
  expand $\mathcal P_\text{mat}$ up to order $q-2$ \;
  impose $C_\text{mat} = C_\text{grav}$ and $V_\text{mat} \subseteq V_\text{grav}$ up to order $q-2$ \textbf{check!!} \;
  \caption{Perturbative gravitational closure using covariant constructive gravity}
\end{algorithm}

The perturbative approach has reduced most of the task of closing a matter field theory with a diffeomorphism invariant and causally compatible gravitational theory to linear algebra---at the cost, of course, that the resulting theory is only an approximation for weak gravitational fields. This approximation, however, is final in the following sense: Because the equivariance equations have been proven to be formally integrable, we can be sure that the truncated power series obtained from the algorithm is as definite as it gets. \cite{Seiler_2010} No prolongation of the equivariance equations to orders higher than $q$ will yield new restrictions on the expansion coefficients up to order $q$. It is still not possible to make a statement about the convergence of the formal power series, so it remains unclear whether this procedure would yield an exact solution if---somehow---performed up to $q=\infty$.

Also note that the expansions of the objects relevant for the calculation of $\mathcal P_\text{grav}(k)$ in steps 6--10 have only been stated explicitly for the case $q=3$. This does not take away from the generality of the algorithm for higher orders, as the necessary expansions follow the same pattern: essentially, one has to consider an expression of the form
\begin{equation}
  \frac{\operatorname{det}(A + \epsilon B)}{a + \epsilon b}
\end{equation}
and expand to whichever order in $\epsilon$ is desired.

Let us close with a list of the equivariance equations and their first prolongations evaluated at an expansion point $N = (N^A,0,0)$. We will perform the construction algorithm for the order $q=3$ in Chap.~\ref{chapter_weak_area}, so it shall suffice to limit ourselves to this order here as well. We use the reduced power series ansatz Eq.~\ref{ansatz_reduced}. The unprolonged equivariance equations evaluated at $N$ are
\begin{equation}\label{prolong_0}
  \begin{aligned}
    0 &{} = a_A \gmc{A}{B}{n}{m} N^B + a \delta^n_m, \\
    0 &{} = a_A^{\hphantom AI}\gmc{A}{B}{(n}{m} J^{pq)}_I N^B.
  \end{aligned}
\end{equation}
The first prolongations evaluate to
\begin{equation}\label{prolong_1}
  \begin{aligned}
    0 &{} = a_A \gmc{A}{B}{n}{m} + 2 a_{AB} \gmc{A}{C}{n}{m} N^C + a_B \delta^n_m, \\
    0 &{} = a_A^{\hphantom AI}\lbrack \gmc{A}{B}{n}{m} \delta^J_I - 2\delta^A_B J^{pn}_I I^J_{pm}\rbrack + a_{AB}^{\hphantom{AB}J}\gmc{A}{C}{n}{m} N^C + a_B^{\hphantom BJ} \delta^n_m, \\
    0 &{} = 2a_{A \hphantom pB}^{\hphantom A(p\hphantom Bq\mid} \gmc{A}{C}{\mid n)}{m} N^C + a_A^{\hphantom AI}\lbrack \gmc{A}{B}{(n}{m} 2J^{p)q}_I - \delta^A_B J^{pn}_I \delta^q_m\rbrack, \\
    0 &{} = a_{BA}^{\hphantom{BA}I} \gmc{A}{C}{(n}{m} J^{pq)}_I N^C + a_A^{\hphantom AI}\gmc{A}{B}{(n}{m} J^{pq)}_I,
  \end{aligned}
\end{equation}
and the second prolongations finally yield
\begin{equation}\label{prolong_2}
  \begin{aligned}
    0 &{} = 2 a_{AC} \gmc{A}{B}{n}{m} + 2 a_{AB} \gmc{A}{C}{n}{m} + 6 a_{ABC} \gmc{A}{D}{n}{m}N^D + 2a_{BC}\delta^n_m, \\
    0 &{} = 2 a_{A\hphantom pC}^{\hphantom Ap\hphantom Cr}\lbrack \gmc{A}{B}{n}{m} \delta^q_p - \delta^A_B\delta^n_p\delta^q_m \rbrack + 2a_{AB\hphantom qC}^{\hphantom{AB}q\hphantom Cr}\gmc{A}{D}{n}{m} N^D + 2a_{B\hphantom qC}^{\hphantom Bq\hphantom Cr}\delta^n_m, \\
    0 &{} = a_{CA}^{\hphantom{CA}I} \lbrack \gmc{A}{B}{n}{m} \delta^J_I - 2 \delta^A_B J^{pn}_I I^J_{pm} \rbrack + 2 a_{ACB}^{\hphantom{ACB}J} \gmc{A}{D}{n}{m} N^D + a_{CB}^{\hphantom{CB}J} \delta^n_m, \\
    0 &{} = 2a_{CA\hphantom{p}B}^{\hphantom{CA}(p\hphantom Bq\mid}\gmc{A}{D}{\mid n)}{m}N^D + a_{CA}^{\hphantom{CA}I} \lbrack \gmc{A}{B}{(n}{m} 2 J^{p)q}_I - \delta^A_B J^{pn}_I \delta^q_m \rbrack, \\
    0 &{} = 2a_{BCA}^{\hphantom{BCA}I} \gmc{A}{D}{(n}{m}J^{pq)}_I N^D + a_{CA}^{\hphantom{CA}I} \gmc{A}{B}{(n}{m} J^{pq)}_I.
  \end{aligned}
\end{equation}

