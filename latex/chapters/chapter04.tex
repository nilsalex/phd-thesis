\chapter{Perturbative construction of gravitational theories}
\label{chapter_perturbation}

\textit{Following the presentation of the axioms of covariant constructive gravity and the construction algorithm, we now develop a perturbative approach for the implementation of both axioms. The equivariance equations turn out to lend themselves to an iterative solution strategy where the expansion coefficients of a power series ansatz are determined iteratively, power by power. A first approximation of the gravitational theory valid for weak fields is obtained already after the second iteration, which yields a quadratic Lagrangian with linear field equations. In a sense, this is the free theory without self-coupling. In order to investigate the lowest-order effects of self-coupling, which we will dare in the subsequent chapter, the next order is indispensable. Therefore, after establishing the general principle, we focus on the perturbation theory up to third order in the Lagrangian.}

\textit{The development in this chapter follows closely the presentation in Ref.~\cite{ccg_paper}.}\textbf{or does it?}

\textbf{take-home message: approach ideally suits itself for construction of theories which govern weak gravitational fields}

\section{Perturbative implementation of axiom 1}

Let us state again, for reference, the equivariance equations \eqref{equivariance_eqn_2}--\eqref{equivariance_eqn_4} we are going to solve perturbatively
\begin{equation*}
    \begin{aligned}
      0 &{} = L_{:A} \gmc{A}{B}{n}{m}u^B + L_{:A}^{\hphantom{:A}p}\left\lbrack\gmc{A}{B}{n}{m} \delta^q_p - \delta^A_B\delta^q_m\delta^n_p\right\rbrack u^{B}_{\hphantom Bq} \nonumber \\
        &{} \hphantom{=} + L_{:A}^{\hphantom{:A}I} \left\lbrack\gmc{A}{B}{n}{m} \delta^J_I - 2 \delta^A_B J^{pn}_{I} I^J_{pm}\right\rbrack u^B_{\hphantom BJ} + L\delta^n_m \\
      0 &{} = L_{:A}^{\hphantom{:A}(p\mid} \gmc{A}{B}{\mid n)}{m} u^B + L_{:A}^{\hphantom{:A}I}\left\lbrack\gmc{A}{B}{(n}{m} 2J^{p)q}_I - \delta^A_B J^{pn}_I \delta^q_m\right\rbrack u^B_{\hphantom Bq} \\
      0 &{} = L_{:A}^{\hphantom{:A}I} \gmc{A}{B}{(n}{m} J^{pq)}_I u^B.
    \end{aligned}
\end{equation*}
The first equivariance equation $0 = L_{,m}$ has been omitted, because we will consider it solved from now on by restricting the problem to Lagrangian densities $L$ which depend only on the fibre coordinates.

Perturbation theory starts with choosing an expansion point $p\in J^2E$. Let $p$ have fibre coordinates $(N^A,N^A_{\hphantom Ap},N^A_{\hphantom AI})$. The deviation of any point $q\in J^2E$ with fibre coordinates $(G^A,G^A_{\hphantom Ap},G^A_{\hphantom AI})$ is then defined as the difference
\begin{equation}
  (H^A, H^A_{\hphantom Ap}, H^A_{\hphantom AI}) \vcentcolon= (G^A - N^A, G^A_{\hphantom Ap} - N^A_{\hphantom Ap}, G^A_{\hphantom AI} - H^A_{\hphantom AI}).
\end{equation}
Around $p$, the formal power series ansatz is
\begin{equation}\label{power_series_ansatz}
  \begin{aligned}
    L &{} = a + a_A H^A + a_A^{\hphantom Ap} H^A_{\hphantom Ap} + a_A^{\hphantom AI} H^A_{\hphantom AI} \\
      &{} \hphantom{=} + a_{AB} H^A H^B + a_{AB}^{\hphantom{AB}p} H^A H^B_{\hphantom Bp} + a_{AB}^{\hphantom{AB}I} H^A H^B_{\hphantom BI} \\
      &{} \hphantom{=} + a_{A\hphantom{p}B}^{\hphantom Ap\hphantom{B}q} H^A_{\hphantom Ap} H^B_{\hphantom Bq} + a_{A\hphantom{p}B}^{\hphantom Ap\hphantom{B}I} H^A_{\hphantom Ap} H^B_{\hphantom BI} + a_{A\hphantom{I}B}^{\hphantom AI\hphantom{B}J} H^A_{\hphantom AI} H^B_{\hphantom BJ} \\
      &{} \hphantom{=} + a_{ABC} H^A H^B H^C + \dots
  \end{aligned}
\end{equation}
and is called \emph{formal} because at this point there is no assumption about the convergence of the power series. We do, however, make two assumptions about admissible expansion points, in order to justify the interpretation of perturbatively constructed theories as valid theories for \emph{weak} gravitational fields.
\begin{enumerate}
  \item{The expansion point represents a \emph{flat} instance of the gravitational field, i.e., both $N^A_{\hphantom Ap}$ and $N^A_{\hphantom AI}$ vanish.}
  \item{At the expansion point, the matter theory that is used to bootstrap the construction procedure reduces to a theory that is equivalent to a matter theory on Minkowski spacetime.}
\end{enumerate}
Both restrictions for $p$ ensure that the limit of weak gravitational fields can match our observations for situations with weak gravity: Matter fields couple to flat geometry in the sense that there are coordinate charts where the geometric coefficients are constant and this geometry is determined by the Minkowski metric. Curvature effects and effects from non-Lorentzian geometry are expected to arise as \emph{deviations} from this ground state. After all, this is just another incarnation of the correspondence principle for modified gravity.

The first assumption is easily implemented: In the chosen coordinate chart, $p$ takes the form $(N^A,0,0)$. The best way to make sense of the second assumption is by considering a few examples:
\begin{example}[flat Lorentzian expansion points]
  Let us choose appropriate expansion points $(N^A,0,0)$ for GLED and bimetric theories introduced in Sections \ref{section_gled} and \ref{section_bimetric}, respectively. In order to satisfy the second assumption made for expansion points, we construct $N^A$ from the Minkowski metric $\eta^{ab} = \operatorname{diag}(1,-1,-1,-1)^{ab}$ in the following ways.
  \begin{enumerate}
    \item{For bimetric theories, a suitable expansion point is given by $N^{\bar A} = J_{ab}^{\bar A} \eta^{ab}$ and $N^{\bar{\bar A}} = J_{ab}^{\bar{\bar A}} \eta^{ab}$, i.e.~setting both metrics $g$ and $h$ equal to $\eta$. Where a scalar density is needed, we choose $\omega = \sqrt{-\operatorname{det}\eta} = 1$. This choice reduceds the bimetric Klein-Gordon theory to the standard Klein-Gordon theory for two scalar fields on Minkowski spacetime
      \begin{equation}
        L_\text{2KG}(N) = \eta^{ab} \phi_{,a} \phi_{,b} - m_\phi^2\phi^2 + \eta^{ab} \psi_{,a} \psi_{,b} - m_\psi^2\psi^2.
      \end{equation}
    Similarly, the refined Proca theory reduces to the standard Proca theory
      \begin{equation}
        L_\text{bi-Proca}(N) = -\eta^{ac}\eta^{bd}F_{ab}F_{cd} + m^2\eta^{ab}A_aA_b.
      \end{equation}}
    \item{For GLED, we choose the expansion point $N^A = J_{abcd}^A (\eta^{ac} \eta^{bd} - \eta^{ad} \eta^{bc} + \epsilon^{abcd})$. Using the density $\omega_G = (\frac{1}{24}\epsilon_{abcd}G^{abcd})^{-1}$, which at $G^A=N^A$ results in $\omega_N = 1$, the Lagrangian density for GLED reduces to
        \begin{equation}\label{GLED_reduction}
        L_\text{GLED} = 2 \eta^{ac}\eta^{bd} F_{ab}F_{cd},
      \end{equation}
    i.e.~Maxwell electrodynamics on Minkowski spacetime.\footnote{The term $\epsilon^{abcd}F_{ab}F_{cd}$ is a surface term and thus does not contribute to the field equations. As such, it has been omitted in Eq.~\ref{GLED_reduction}}}
  \end{enumerate}
\end{example}
Both choices of expansion points ensure that the perturbatively constructed gravitational theories provide to zeroth order in the deviation a background on which known physics is reproduced. Novel physics---the coupling of matter fields to non-metric geometries and the self-coupling of such geometries---should emerge as effect of first and higher orders in the deviation from the Minkowski background.

Having defined an expansion point, the equivariance equations can---in principle---be solved perturbatively by repeating the following process: All equations in the system contain derivatives of first order, so the expansion coefficient $a$ of zeroth order remain undetermined. In order to determine the expansion coefficients $a_A$, $a_A^{\hphantom Ap}$, and $a_A^{\hphantom aI}$, substitute the formal power series ansatz \eqref{power_series_ansatz} for the Lagrangian density $L$ in the equivariance equations, evaluate the result at $N$ (i.e.~set the deviation $H$ to zero) and solve the resulting linear equations for the first-order coefficients. Next, differentiate each PDE once with respect to every independent variable, substitute again the power series ansatz, evaluate at $N$ and solve the linear system for the expansion coefficients of second order. Now repeat this process of differentiation, substitution, evaluation, and solving of linear equations \emph{ad infinitum}---or up to the desired perturbation order.
\section{Involution analysis}
For the previously described perturbative solution process to play out as desired, the PDE system must observe an important property: We need to be sure that each step really determines all expansion coefficients for the corresponding order to the extent that this is possible\footnote{Of course, the equivariance equations, in general, will not determine \emph{all} expansion coefficients. Rather, the solutions will be parameterized exactly by the coefficients that cannot be determined.}. This is not always guaranteed, as a simple example demonstrates.
\begin{example}[integrability conditions\cite{seiler_habil}]\label{example_involution_1}
  Consider the linear, first-order PDE system
  \begin{equation}\label{example_integrability_condition}
    \begin{aligned}
      u_{,z} + y u_{,x} &{} = 0, \\
      u_{,y} &{} = 0
    \end{aligned}
  \end{equation}
  for one function $u$ which depends on three independent variables $x,y,z$. Making a formal power series ansatz, inserting this ansatz into the system \label{example_integrability_condition}, and evaluating at the expansion point yields a linear system of rank two for the three expansion coefficients of first order.

  There are, however, hidden equations governing the first order, which emerge after differentiating the first equation with respect to $y$ and the second equation with respect to $z$ and $x$. This gives new PDEs
  \begin{equation}
    \begin{aligned}
      u_{,yz} + y u_{,xy} + u_{,x} &{} = 0, \\
      u_{,xy} &{} = 0, \\
      u_{,yz} &{} = 0.
    \end{aligned}
  \end{equation}
  The second derivatives in the first equation can be cancelled using the second and third equation, yielding the first-order PDE $u_{,x} = 0$. Such a new equation that is algebraically independent of the original PDEs \eqref{example_integrability_condition} is called an \textbf{integrability condition}. Including it in the first-order system and simplifying a bit, we get
  \begin{equation}
    \begin{aligned}
      u_{,x} &{} = 0, \\
      u_{,y} &{} = 0, \\
      u_{,z} &{} = 0.
    \end{aligned}
  \end{equation}
  Only after performing this procedure of making explicit the hidden first-order PDEs, we know for sure that the expansion coefficients of first order are determined already after the first iteration. In this case, the resulting linear system has full rank, leaving no coefficient undetermined.
\end{example}
Luckily, the system of equivariance equations suffers none of these maladies, as we will prove in the following. The mathematical framework that allows to make such a statement is \emph{involution theory}\cite{seiler_involution}. Within this framework, a PDE of order $q$ is defined geometrically as fibred submanifold $R_q\subseteq J^qE$ of some jet bundle manifold $J^qE$.\footnote{Note that this jet bundle is \emph{not} the jet bundle on which the Lagrangian density is defined. For the equivariance equations, the order $q$ is 1 and the underlying bundle $E$ is $J^2E_\text{geometry}$.} A local coordinate representation of $R_q$ yields a system of equations, more closely resembling what a PDE looks like in the non-geometric picture. Note that we deliberately call $R_q$ a partial differential \emph{equation}, rather than using the plural, as this approach makes no difference between systems or scalar equations. A solution to a PDE is just a local section $\sigma$ of $E$ such that the image of $j^q\sigma$ is contained within $R_q$.

Two geometric operations will be performed repeatedly on PDEs for their involution analysis: \emph{prolongation} and \emph{projection}. The former maps a PDE $R_q$ to some PDE $R_{q+r}$ by, in local coordinates, adding to $R_q$ all possible derivatives of order $r$ of the individual equations---the geometric construction is a bit more involved. On the contrary, it is simpler to define projections geometrically, which is as bundle projections $R^{(r)}_{q-r} = \pi^q_{q-r}(R_q)$. Using a local representation of $R_q$, the projection is performed by eliminating derivatives of higher orders using only algebraic manipulations such that equations of order $q-r$ remain. The maximal set of such equations is a representation of $R_{q-r}$. For linear systems, the task of projecting a PDE to lower order is solved by linear algebra with tools like Gaussian elimination and has already been demonstrated earlier in Example \ref{example_involution_1}.

As a last ingredient, we need the definition of the \emph{geometric symbol} $M_q$. Using a coordinate representation, $M_q$ is obtained by differentiating the equations with respect to the highest derivatives of the unknown functions. With this, the main result can be established.

\begin{theorem}[formal integrability of equivariance equations]\label{thm_formal_integrability}
  The equivariance equations are a formally integrable partial differential equation $R_q$ with $q=1$, i.e.~it holds for all $r>0$ that $R^{(1)}_{q+r} = R_{q+r}$.
\end{theorem}

Formal integrability as defined in Thm.~\ref{thm_formal_integrability} captures in geometric terms the requirement a PDE must satisfy in order for the iterative solution strategy to succeed. Otherwise, a truncated power series solution---which will later serve as approximate solution for weak gravitational fields---could never be trusted, as prolongations of the PDE to higher orders could always yield additional constraints on the coefficients of the truncated series.

\textbf{to be continued ...}

\section{Lorentz invariant ansätze}

In order to implement the second assumption for suitable expansion points in the power series ansatz, we choose coordinate representations where the flat geometry is Lorentz invariant, i.e.~satisfies the Lorentz invariance conditions
\begin{equation}\label{lorentz_invariance_N}
  0 = N^A \gmc{B}{A}{n}{m} (K_{(i)})^m_n,
\end{equation}
where $K_{(i)}$ are the 6 generators $\{ \eta^{m\lbrack r}\delta^{s\rbrack}_n \mid r < s \}$ of the Lorentz group. This special symmetry of the expansion point carries over to the equivariance equations and causes rank defects, for example in the second equivariance equation \eqref{equivariance_eqn_2}. At a generic (non-Lorentz invariant) point $p=(x^i,M^A,0,0)$, it reads
\begin{equation}
  0 = L_{:A}\rvert_p \gmc{A}{B}{n}{m} M^B + L\rvert_p \delta^n_m
\end{equation}
and is, in general, of rank 16. Evaluating the same equation at $p_0 = (x^i,N^A,0,0)$ and contracting with Lorentz generators $K_{(i)}$, we obtain the 6 vanishing linear combinations
\begin{equation}
  \begin{aligned}
    0 &{} = L_{:A}\rvert_{p_0} \gmc{A}{B}{n}{m} N^B (K_{(i)})^m_n + L\rvert_{p_0} \delta^n_m (K_{(i)})^m_n \\
      &{} = 0.
  \end{aligned}
\end{equation}
In the end, only 10 equations remain linearly independent. While at the first glance this seems to reducefthe number of determinable expansion coefficients, the inverse is actually true: Consider again the second equivariance equation and calculate the prolongation with respect to the variables $u^A$. Evaluated at $p_0$, this gives
\begin{equation}
  0 = L_{:A:B}\rvert_{p_0} \gmc{B}{C}{n}{m} N^C + L_{:B}\rvert_{p_0} \gmc{B}{A}{n}{m} + L_{:A}\rvert_{p_0} \delta^n_m,
\end{equation}
which contracted with the Lorentz generators reduces again to first-order equations
\begin{equation}
  0 = L_{:B}\rvert_{p_0}\gmc{B}{A}{n}{m}(K_{(i)})^m_n.
\end{equation}
Comparing this equation with Eq.~\ref{lorentz_invariance_N} emphasizes its significance: It mandates Lorentz invariance of the expansion coefficients $L_{:B}\rvert_{p_0} = a_B$.

Similar results hold for all other expansion coefficients and are obtained exactly the same way: Calculate prolongations of the second equivariance equation, evaluate at the Lorentz invariant expansion point, and contract with the Lorentz generators. While this yields new independent equations of order $q$ by prolongation to order $q+1$ and subsequent projection, it is important not to conflate the Lorentz invariance conditions on expansion coefficients with integrability conditions from involution theory. The former are an artefact of the expansion point with additional symmetries and are as such only valid exactly there, while an integrability condition would not be restricted to singular points.

When solving the equivariance equations iteratively, we could just include the Lorentz invariance conditions and solve them together with the original equations. A better way is to exploit the nature of the additional conditions and implement Lorentz invariance of the expansion coefficients \emph{before} substituting the ansatz in the equivariance equations. For example, working on the metric bundle, rather than including the 60 equations
\begin{equation}
  a_B \gmc{B}{A}{n}{m}(K_{(i)})^m_n
\end{equation}
for the 10-dimensional ansatz $a_B$, we implement Lorentz invariance by reducing $a_B$ to the ansatz
\begin{equation}
  a_B = c\cdot J_B^{ab} \eta_{ab}
\end{equation}
with just one undetermined coefficient. Not only did we get by without adding equations to the system, but we reduced the number of unknowns significantly.

A particular reduction we can perform right now is to set expansion coefficients with an \emph{odd} number of indices to zero.\footnote{For field bundles that are defined as proper subbundle of some ``unrestricted'' tensor bundle, the number of indices refers to the rank of the latter.} Assuming that the number of indices on the geometry is even\footnote{Otherwise, we would not be able to define a Lorentz invariant expansion point to begin with.}, this removes all coefficients with odd total number of derivatives from the ansatz, e.g.~$a_{A\hphantom pB}^{\hphantom Ap\hphantom BI}=0$.

\section{Perturbative implementation of axiom 2}

Before deriving consequences from the second axiom for the perturbatively constructed solutions, we can already infer restrictions on the perturbation ansatz. As the matter Lagrangians considered here depend on the geometry only locally, and so do the corresponding principal polynomials, a matching gravitational polynomial must also depend on the geometry locally, i.e.~not via derivatives. In order to enforce this, we remove ansätze with a total number of derivatives greater than two and obtain the general ansatz
\begin{equation}\label{ansatz_reduced}
  \begin{aligned}
    L &{} = a + a_A H^A + a_A^{\hphantom AI} H^A_{\hphantom AI} + a_{AB} H^A H^B + a_{AB}^{\hphantom{AB}I} H^A H^B_{\hphantom BI} \\
      &{} \hphantom{=} + a_{ABC} H^A H^B H^C + a_{AB\hphantom pC}^{\hphantom{AB}p\hphantom Cq} H^A H^B_{\hphantom Bp} H^C_{\hphantom Cq} + a_{ABC}^{\hphantom{ABC}I} H^A H^B H^C_{\hphantom CI} + \dots \ .
  \end{aligned}
\end{equation}
As discussed before, all expansion coefficients are Lorentz invariant.

Now, consider a solution of the equivariance equations for the ansatz \eqref{ansatz_reduced}, truncated at order $q+1$. The corresponding field equations will be of order $q$ and the principal symbol, consequently, of order $q-1$. The second axiom of covariant constructive gravity is implemented perturbatively by matching the expansion
\begin{equation}\label{expansion_matter_poly}
  \mathcal P_\text{mat} = (P^{(0)}_\text{mat}) + (P^{(1)}_\text{mat})_A H^A + \dots + (P^{(q-1)}_\text{mat})_{A_1\dots A_{q-1}} H^{A_1} \dots H^{A_{q-1}} + \mathcal O(q)
\end{equation}
of the matter polynomial with the expansion
\begin{equation}\label{expansion_grav_poly}
  \mathcal P_\text{grav} = (P^{(0)}_\text{grav}) + (P^{(1)}_\text{grav})_A H^A + \dots + (P^{(q-1)}_\text{grav})_{A_1\dots A_{q-1}} H^{A_1} \dots H^{A_{q-1}} + \mathcal O(q)
\end{equation}
of the gravitational polynomial. Note that a ``match'' does not necessarily mean that both polynomials coincide, but rather that the causalities are compatible in the sense of Def.~\ref{causal_compatibility_def}.

While the expansion \eqref{expansion_matter_poly} generally follows from a closed form for the matter principal polynomial, we only have the currently constructed orders of the gravitational Lagrangian at our disposal when calculating terms from Eq.~\ref{expansion_grav_poly}. The process to arrive at the gravitational polynomial from there by expanding the definition \eqref{principal_polynomial}, however, is straightforward. We restrict our attention to the order $q=2$ in the field equations, which is the maximum order we will consider for a concrete example later, but the calculations can be generalized to higher orders if necessary.

We start with separating the perturbation orders in the vectors $\chi_{(n)}(k)$ spanning the left and right kernels of the principal symbol as
\begin{equation}
  \chi_{(n)}^A(k) = \gmc{A}{B}{n}{m}N^Bk_m + \gmc{A}{B}{n}{m}H^Bk_m =\vcentcolon (\chi^{(0)})^A_n(k) + (\chi^{(1)})^A_{Bn}(k)H^B.
\end{equation}
From there, the denominator in Eq.~\ref{expansion_grav_poly}, which will be abbreviated as $f^{(A_1\dots A_s)(B_1\dots B_s)}(k)$ in the following, can be expanded into
\begin{equation}
  f^{(A_1\dots A_s)(B_1\dots B_s)}(k) = (f_{(0)})^{(A_1\dots A_s)(B_1\dots B_s)}(k) + (f_{(1)})^{(A_1\dots A_s)(B_1\dots B_s)}_C(k)H^C + \mathcal O(2).
\end{equation}
For the numerator, we choose a submatrix $T^{(A_1\dots A_s)(B_1\dots B_s)}(k)$ of the principal symbol $T(k)$ which is of full rank, i.e.~has a non-vanishing determinant.\footnote{This sounds like a hard problem in practice, but turns out to be quite feasible. While the matrices contain symbolic entries given by undetermined expansion coefficients of the Lagrangian density and covector components $k_a$, ranks can actually be calculated using randomly drawn numeric values for the symbolic entries. In the worst case, we introduce additional linear dependencies and obtain a lower rank. If the rank obtained by such a calculation is maximal, on the other hand, we have nothing to worry about and can trust the result. For the examples encountered later on, it is possible to perform all calculations with arbitrary precision arithmetic on integers and use fraction-free Gaussian elimination, yielding results without any numerical instabilities.}
The symbol submatrix expands as
\begin{equation}
  T^{(A_1\dots A_s)(B_1\dots B_s)}(k) = (T_{(0)})^{(A_1\dots A_s)(B_1\dots B_s)}(k) + (T_{(1)})^{(A_1\dots A_s)(B_1\dots B_s)}_C(k)H^C + \mathcal O(2) 
\end{equation}

